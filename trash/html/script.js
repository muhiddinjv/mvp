const baqara282arab =
  "يَـٰٓأَيُّهَا ٱلَّذِينَ ءَامَنُوٓا۟ إِذَا تَدَايَنتُم بِدَيْنٍ إِلَىٰٓ أَجَلٍۢ مُّسَمًّۭى فَٱكْتُبُوهُ ۚ وَلْيَكْتُب بَّيْنَكُمْ كَاتِبٌۢ بِٱلْعَدْلِ ۚ وَلَا يَأْبَ كَاتِبٌ أَن يَكْتُبَ كَمَا عَلَّمَهُ ٱللَّهُ ۚ فَلْيَكْتُبْ وَلْيُمْلِلِ ٱلَّذِى عَلَيْهِ ٱلْحَقُّ وَلْيَتَّقِ ٱللَّهَ رَبَّهُۥ وَلَا يَبْخَسْ مِنْهُ شَيْـًۭٔا ۚ فَإِن كَانَ ٱلَّذِى عَلَيْهِ ٱلْحَقُّ سَفِيهًا أَوْ ضَعِيفًا أَوْ لَا يَسْتَطِيعُ أَن يُمِلَّ هُوَ فَلْيُمْلِلْ وَلِيُّهُۥ بِٱلْعَدْلِ ۚ وَٱسْتَشْهِدُوا۟ شَهِيدَيْنِ مِن رِّجَالِكُمْ ۖ فَإِن لَّمْ يَكُونَا رَجُلَيْنِ فَرَجُلٌۭ وَٱمْرَأَتَانِ مِمَّن تَرْضَوْنَ مِنَ ٱلشُّهَدَآءِ أَن تَضِلَّ إِحْدَىٰهُمَا فَتُذَكِّرَ إِحْدَىٰهُمَا ٱلْأُخْرَىٰ ۚ وَلَا يَأْبَ ٱلشُّهَدَآءُ إِذَا مَا دُعُوا۟ ۚ وَلَا تَسْـَٔمُوٓا۟ أَن تَكْتُبُوهُ صَغِيرًا أَوْ كَبِيرًا إِلَىٰٓ أَجَلِهِۦ ۚ ذَٰلِكُمْ أَقْسَطُ عِندَ ٱللَّهِ وَأَقْوَمُ لِلشَّهَـٰدَةِ وَأَدْنَىٰٓ أَلَّا تَرْتَابُوٓا۟ ۖ إِلَّآ أَن تَكُونَ تِجَـٰرَةً حَاضِرَةًۭ تُدِيرُونَهَا بَيْنَكُمْ فَلَيْسَ عَلَيْكُمْ جُنَاحٌ أَلَّا تَكْتُبُوهَا ۗ وَأَشْهِدُوٓا۟ إِذَا تَبَايَعْتُمْ ۚ وَلَا يُضَآرَّ كَاتِبٌۭ وَلَا شَهِيدٌۭ ۚ وَإِن تَفْعَلُوا۟ فَإِنَّهُۥ فُسُوقٌۢ بِكُمْ ۗ وَٱتَّقُوا۟ ٱللَّهَ ۖ وَيُعَلِّمُكُمُ ٱللَّهُ ۗ وَٱللَّهُ بِكُلِّ شَىْءٍ عَلِيمٌۭ";

const baqara282roman =
  "yaā'aayuhā al-aḏyna āmanwā 'iiḏā tadāyantum bidaynin 'iilaỳā 'aaǧalin musamanỳ fāktubwhu  walyaktub baynakum kātibun bilʿadli  walā ya'aba kātibun 'aan yaktuba kamā ʿalamahu al-lahu  falyaktub walyumlili al-aḏiỳ ʿalayhi al-ḥaqu walyataqi al-laha rabahu walā yabẖas minhu šayanā  fa'iin kāna al-aḏiỳ ʿalayhi al-ḥaqu safyhanā 'aaw ḍaʿyfanā 'aaw lā yastaṭyʿu 'aan yumila hwa falyumlil walyuhu bilʿadli  wāstašhidwā šahydayni min riǧālikum  fa'iin lam yakwnā raǧulayni faraǧulun wāmra'aatāni miman tarḍawna mina aš-šuhadā'i 'aan taḍila 'iiḥdaỳāhumā fatuḏakira 'iiḥdaỳāhumā al-'auẖraỳā  walā ya'aba aš-šuhadā'u 'iiḏā mā duʿwā  walā tasamwā 'aan taktubwhu ṣaġyranā 'aaw kabyranā 'iilaỳā 'aaǧalihi  ḏālikum 'aaqsaṭu ʿinda al-lahi wa'aaqwamu lilšahaādati wa'aadnaỳā 'aalā tartābwā  'iilā 'aan takwna tiǧaāratan ḥāḍiratan tudyrwnahā baynakum falaysa ʿalaykum ǧunāḥun 'aalā taktubwhā  wa'aašhidwā 'iiḏā tabāyaʿtum  walā yuḍāra kātibun walā šahydun  wa'iin tafʿalwā fa'iinahu fuswqun bikum  wātaqwā al-laha  wayuʿalimukumu al-lahu  wāllahu bikuli šaỳ'in ʿalymun";

const alImran154hasAllArabicLetters =
  "ثُمَّ أَنزَلَ عَلَيۡكُم مِّنۢ بَعۡدِ ٱلۡغَمِّ أَمَنَةٗ نُّعَاسٗا يَغۡشَىٰ طَآئِفَةٗ مِّنكُمۡۖ وَطَآئِفَةٞ قَدۡ أَهَمَّتۡهُمۡ أَنفُسُهُمۡ يَظُنُّونَ بِٱللَّهِ غَيۡرَ ٱلۡحَقِّ ظَنَّ ٱلۡجَٰهِلِيَّةِۖ يَقُولُونَ هَل لَّنَا مِنَ ٱلۡأَمۡرِ مِن شَيۡءٖۗ قُلۡ إِنَّ ٱلۡأَمۡرَ كُلَّهُۥ لِلَّهِۗ يُخۡفُونَ فِيٓ أَنفُسِهِم مَّا لَا يُبۡدُونَ لَكَۖ يَقُولُونَ لَوۡ كَانَ لَنَا مِنَ ٱلۡأَمۡرِ شَيۡءٞ مَّا قُتِلۡنَا هَٰهُنَاۗ قُل لَّوۡ كُنتُمۡ فِي بُيُوتِكُمۡ لَبَرَزَ ٱلَّذِينَ كُتِبَ عَلَيۡهِمُ ٱلۡقَتۡلُ إِلَىٰ مَضَاجِعِهِمۡۖ وَلِيَبۡتَلِيَ ٱللَّهُ مَا فِي صُدُورِكُمۡ وَلِيُمَحِّصَ مَا فِي قُلُوبِكُمۡۚ وَٱللَّهُ عَلِيمُۢ بِذَاتِ ٱلصُّدُورِ";

const alImran154roman =
  "thumma anzala ʿalaykum min baʿdi l-ghami amanatan nuʿāsan yaghshā ṭāifatan minkum waṭāifatun qad ahammathum anfusuhum yaẓunnūna bil-lahi ghayra l-ḥaqi ẓanna l-jāhiliyati yaqūlūna hal lanā mina l-amri min shayin qul inna l-amra kullahu lillahi yukh'fūna fī anfusihim mā lā yub'dūna laka yaqūlūna law kāna lanā mina l-amri shayon mā qutil'nā hāhunā qul law kuntum fī buyūtikum labaraza alladhīna kutiba ʿalayhimu l-qatlu ilā maḍājiʿihim waliyabtaliya l-lahu mā fī ṣudūrikum waliyumaḥḥiṣa mā fī qulūbikum wal-lahu ʿalīmun bidhāti l-ṣudūri";

  const romanized = {
    'ء': "'",        // hamza
    'ٱ': "a",        // wasla on alif
    'آ': "'a",       // madda on alif
    'أ': "a",        // hamza on alif (initial)
    'ؤ': "v",        // hamza on waw
    'إ': "i",        // hamza on alif (under)
    'ئ': "y",        // hamza on ya
    'ا': "a",        // alif
    'ب': "b",        // ba
    'ت': "t",        // ta
    'ة': "h",        // ta marbuta (can be rendered as 't' in pause forms)
    'ث': "th",       // tha
    'ج': "j",        // jim
    'ح': "h",        // ha (pharyngeal; sometimes rendered as ḥ)
    'خ': "kh",       // kha
    'د': "d",        // dal
    'ذ': "dh",       // dhal
    'ر': "r",        // ra
    'ز': "z",        // zayn
    'س': "s",        // sin
    'ش': "sh",       // shin
    'ص': "s",        // sad (or ṣ)
    'ض': "d",        // dad (or ḍ)
    'ط': "t",        // ta (emphatic; or ṭ)
    'ظ': "z",        // za (emphatic; or ẓ)
    'ع': "a",        // ain (often rendered as ʿ)
    'غ': "gh",       // ghain
    'ف': "f",        // fa
    'ق': "q",        // qaf
    'ك': "k",        // kaf
    'ل': "l",        // lam
    'م': "m",        // mim
    'ن': "n",        // nun
    'ه': "h",        // ha
    'و': "w",        // waw
    'ي': "y",        // ya
    'ى': "ỳ",        // alif maqṣūra
    'َ': "a",        // fatha
    'ُ': "u",        // damma
    'ِ': "i",        // kasra
    'ً': "an",       // fathatan
    'ٌ': "un",       // dammatan
    'ٍ': "in",       // kasratan
    'ْ': ".",         // sukun PROBLEMATIC
    'ّ': "."          // shadda indicator (doubling is handled in processing)
  };
  

// const romanized_old = {
//   ء: "'", // hamza,
//   ٱ: "a", //aa
//   آ: "'a", // madda
//   أ: "a", // hamza on alif
//   ؤ: "v", // hamza on waw
//   إ: "i", // hamza on alif
//   ئ: "y", // hamza on ya
//   ا: "a", // alif
//   ب: "b", // ba
//   ت: "t", // ta
//   ة: "t", //t
//   ث: "th", // tha
//   ج: "j", // jim
//   ح: "h", // ha
//   خ: "kh", // kha
//   د: "d", // dal
//   ذ: "th", // thal
//   ر: "r", // ra
//   ز: "z", // zayn
//   س: "s", // sin
//   ش: "sh", // shin
//   ص: "s", // sad
//   ض: "d", // dad
//   ط: "t", // ta
//   ظ: "z", // za
//   ع: "a", // ain
//   غ: "gh", // ghain
//   ف: "f", // fa
//   ق: "q", // qaf
//   ك: "k", // kaf
//   ل: "l", // lam
//   م: "m", // mim
//   ن: "n", // nun
//   ه: "h", // ha
//   و: "w", // waw
//   ي: "y", // ya
//   ى: "ỳ", //ya
//   "َ": "a", // fatha
//   "ُ": "u", // damma
//   "ِ": "i", // kasra
//   "ً": "an", // fathatan
//   "ٌ": "un", // dammatan
//   "ُُ": "un", // dammatan
//   "ٍ": "in", // kasratan
//   "ْ": "", // sukun
//   "ّ": "²", // double stop
// };

// const aralphabet = {
//     ء: "(h)amza", // (h)amza,
//     ٱ: "(w)alif", // wasla on alif
//     آ: "(m)alif", // madda on alif
//     أ: "(h)alif", // hamza on alif
//     ؤ: "(h)waw", // hamza on waw
//     إ: "ee", // hamza on alif
//     ئ: "(h)ya", // hamza on ya
//     ا: "alif",
//     ب: "ba",
//     ت: "ta",
//     ث: "tha",
//     ج: "jim",
//     ح: "ha",
//     خ: "kha",
//     د: "dal",
//     ذ: "thal",
//     ر: "ra",
//     ز: "zayn",
//     س: "sin",
//     ش: "shin",
//     ص: "sad",
//     ض: "dad",
//     ط: "ta",
//     ظ: "za",
//     ع: "ain",
//     غ: "ghain",
//     ف: "fa",
//     ق: "qaf",
//     ك: "kaf",
//     ل: "lam",
//     م: "meem",
//     ن: "noon",
//     ه: "ha",
//     و: "waw",
//     ي: "ya",
//     ى: "ỳa",
//   };

 
  
  const aralphabet = {
    ء: "(h)amza",
    ٱ: "(w)asla",
    آ: "(m)adda",
    أ: "(h)amza on alif",
    ؤ: "(h)amza on waw",
    إ: "(h)amza under alif",
    ئ: "(h)amza on ya",
    ا: "alif",
    ب: "ba",
    ت: "ta",
    ة: "ta marbuta",
    ث: "tha",
    ج: "jim",
    ح: "ḥa",
    خ: "kha",
    د: "dal",
    ذ: "dhal",
    ر: "ra",
    ز: "zayn",
    س: "sin",
    ش: "shin",
    ص: "ṣad",
    ض: "ḍad",
    ط: "ṭa",
    ظ: "ẓa",
    ع: "ʿain",
    غ: "ghain",
    ف: "fa",
    ق: "qaf",
    ك: "kaf",
    ل: "lam",
    م: "mim",
    ن: "nun",
    ه: "ha",
    و: "waw",
    ي: "ya",
    ى: "alif maqṣūra"
  };

  const arabiColored_2 = {
    ء: "PeachPuff",         // hamza
    ٱ: "DeepSkyBlue",       // aa //DarkCyan
    آ: "BlanchedAlmond",    // madda
    أ: "Aqua",              // hamza on alif
    ؤ: "LightCoral",        // hamza on waw
    إ: "DarkTurquoise",     // hamza on alif
    ئ: "DarkSalmon",        // hamza on ya
    ا: "Crimson",
    ب: "Navy",
    ت: "Coral",
    ث: "Olive",
    ج: "Teal",
    ح: "Maroon",
    خ: "SkyBlue",
    د: "Sienna",
    ذ: "Turquoise",
    ر: "Indigo",
    ز: "Salmon",
    س: "ForestGreen",
    ش: "Blue",              // shin
    ص: "SlateGray",
    ض: "Gold",
    ط: "DarkOrange",
    ظ: "SteelBlue",
    ع: "DarkKhaki",
    غ: "Orchid",
    ف: "MediumPurple",
    ق: "DarkSlateBlue",
    ك: "Tomato",
    ل: "MediumSeaGreen",
    م: "RoyalBlue",         // changed from DarkTurquoise to ensure uniqueness
    ن: "MediumVioletRed",
    ه: "DodgerBlue",
    و: "DarkOliveGreen",
    ي: "MediumAquamarine",
    ى: "Lavender"           // ya
  };

const arabiColored_1 = {
  ء: "PeachPuff", // hamza
  ٱ: "DeepSkyBlue", //aa
  آ: "BlanchedAlmond", // madda
  أ: "Aqua", // hamza on alif
  ؤ: "LightCoral", // hamza on waw
  إ: "DarkTurquoise", // hamza on alif
  ئ: "DarkSalmon", // hamza on ya
  ا: "Crimson",
  ب: "Navy",
  ت: "Coral",
  ث: "Olive",
  ج: "Teal",
  ح: "Maroon",
  خ: "SkyBlue",
  د: "Sienna",
  ذ: "Turquoise",
  ر: "Indigo",
  ز: "Salmon",
  س: "ForestGreen",
  ش: "Blue", //shin
  ص: "SlateGray",
  ض: "Gold",
  ط: "DarkOrange",
  ظ: "SteelBlue",
  ع: "DarkKhaki",
  غ: "Orchid",
  ف: "MediumPurple",
  ق: "DarkSlateBlue",
  ك: "Tomato",
  ل: "MediumSeaGreen",
  م: "DarkTurquoise",
  ن: "MediumVioletRed",
  ه: "DodgerBlue",
  و: "DarkOliveGreen",
  ي: "MediumAquamarine",
  ى: "Lavender", //ya
};

const romanColors = {
  "'": "LightCoral",       // hamza
  A: "LightGreen",         // A
  A_madda: "LightBlue",     // A (madda)
  O: "Gold",               // O
  V: "MediumPurple",       // V
  I: "Tomato",             // I
  Y: "SlateBlue",          // Y
  a: "Crimson",            // a
  b: "Navy",               // b
  t: "Coral",              // t
  ð: "Olive",            // ð
  j: "Teal",               // j
  h: "Maroon",             // h
  x: "SkyBlue",            // x
  d: "Sienna",             // d
  ž: "Turquoise",        // ž
  r: "Indigo",             // r
  z: "Salmon",             // z
  s: "ForestGreen",        // s
  š: "Blue",             // š
  c: "SlateGray",          // c
  Ð: "DarkGoldenRod",    // Ð
  t2: "DarkOrange",        // alternate t if needed
  Z: "SteelBlue",          // Z
  æ: "DarkKhaki",          // æ
  g: "Orchid",             // g
  f: "MediumOrchid",       // f
  q: "DarkSlateBlue",      // q
  k: "Chocolate",          // k
  l: "MediumSeaGreen",     // l
  m: "DarkTurquoise",      // m
  n: "MediumVioletRed",    // n
  H: "DodgerBlue",         // H
  w: "DarkOliveGreen",     // w
  y: "MediumAquamarine"    // y
};


// const romanColors = {
//   "'": "LightCoral", // hamza,
//   A: "LightGreen", // unique color for 'A'
//   A: "LightBlue", // unique color for 'A' (madda)
//   O: "Gold", // unique color for 'O'
//   V: "MediumPurple", // unique color for 'V'
//   I: "Tomato", // unique color for 'I'
//   Y: "SlateBlue", // unique color for 'Y'
//   a: "Crimson", // unique color for 'a'
//   b: "Navy",
//   t: "Coral",
//   ð: "Olive", //th
//   j: "Teal",
//   h: "Maroon",
//   x: "SkyBlue",
//   d: "Sienna",
//   ž: "Turquoise", //z'
//   r: "Indigo",
//   z: "Salmon",
//   s: "ForestGreen",
//   š: "Blue", //shin
//   c: "SlateGray",
//   Ð: "Gold", //dod
//   t: "DarkOrange", //t^
//   Z: "SteelBlue", //z^
//   æ: "DarkKhaki", //a'
//   g: "Orchid",
//   f: "MediumPurple",
//   q: "DarkSlateBlue",
//   k: "Tomato",
//   l: "MediumSeaGreen",
//   m: "DarkTurquoise",
//   n: "MediumVioletRed",
//   H: "DodgerBlue", //ha
//   w: "DarkOliveGreen",
//   y: "MediumAquamarine",
// };

const arabiColored = arabiColored_1;

function colorizeText(text, arabiColored) {
  let html = "";
  let colorIndex = 0;
  const colors = Object.values(arabiColored); // Pre-store colors to cycle through

  text.split(" ").forEach((word) => {
    let wordHtml = "";

    for (let i = 0; i < word.length; i++) {
      let letter = word[i];

      // if (letter === 'ْ') continue; // ✅ Ignore '*'

      let color = arabiColored[letter] || colors[colorIndex]; // Assign a color
      colorIndex = (colorIndex + 1) % colors.length; // Rotate colors

      wordHtml += `<span style="color:${color}">${letter}</span>`;
    }

    html += `${wordHtml} `; // Preserve word spacing
  });

  return html.trim(); // Ensure no trailing spaces
}

function romanizeArabic(text, romanized) {
  return text
    .split("") 
    .filter(char => char !== 'ْ') //ignore sukun
    .map((char, index, array) => {
      const letter = romanized[char] || char; // Get mapped value or keep original

      // Pick color based on current, previous, or next char
      let color = arabiColored[char] || 
                  arabiColored[array[index - 1]] || 
                  arabiColored[array[index + 1]] || 
                  "black"; // Default color if none found

      return `<span style="color: ${color}">${letter}</span>`;
    })
    .join("");
}

function generateTable(arabiColored, alphabet) {
  let table = "<div class='grid-container'>";

  for (const [letter, color] of Object.entries(arabiColored)) {
    let transliteration = "";

    transliteration = alphabet[letter];

    table += `<div class="grid-item">
          <div class="letter" style="color:${color}" onclick="toggleFade('${letter}')">${letter}</div>
          <div class="translit">${transliteration}</div>
        </div>`;
  }

  table += "</div>";

  return table;
}

function toggleFade(translit) {
  const spans = document.querySelectorAll(".output span");
  const filteredSpans = Array.from(spans).filter((span) =>
    span.textContent.includes(translit)
  );

  filteredSpans.forEach((span) => {
    if (span.style.animation) {
      span.style.animation = "";
    } else {
      span.style.animation = "fade 1s infinite";
    }
  });
}

function typeWriter(text, targetElement, speed) {
  let index = 0;

  function type() {
    if (index < text.length) {
      targetElement.innerHTML += text.charAt(index);
      index++;
      setTimeout(type, speed);
    }
  }

  type();
}

const story = 'هناك ولد. اسمه إيلون ماسك. يومًا ما، يذهب إلى المتجر لأنه يريد شراء صاروخ. يشتري صاروخ لعبة. هو سعيد.'

const tprs = "ٱلْوَلَدُ هُوَ سَعِيدٌ"

const tprs2 = "هُنَاكَ وَلَدٌ"

document.querySelector(".table").innerHTML = generateTable(
  arabiColored,
  aralphabet
);

document.querySelector(".arabic").innerHTML = colorizeText(
  tprs2,
  arabiColored
);

document.querySelector(".romanized").innerHTML = romanizeArabic(
  tprs2, 
  romanized
);

// document.getElementById("typeButton").addEventListener("click", function() {
//   const targetElement = document.getElementById("output");
//   targetElement.innerHTML = ""; // Clear previous text
//   typeWriter(romanizeArabic(
//     tprs, 
//     romanized
//   ), targetElement, 100); // 100 ms delay
// });